# SPDX-FileCopyrightText: 2022 Dennis Gl√§ser <dennis.glaeser@iws.uni-stuttgart.de>
# SPDX-License-Identifier: MIT

name: test-suite

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
    paths-ignore:
      - 'docker/**'
  schedule:
    - cron: '30 22 * * 0,3'
  workflow_dispatch:

env:
  DEFAULT_COMPILER_PKG: g++-12
  DEFAULT_C_COMPILER: gcc-12
  DEFAULT_CXX_COMPILER: g++-12
  OMPI_ALLOW_RUN_AS_ROOT: 1
  OMPI_ALLOW_RUN_AS_ROOT_CONFIRM: 1

jobs:
  test-compilers:
    runs-on: ubuntu-22.04
    container: dglaeser/gridformat-action-images:full
    steps:
      - name: checkout-repository
        uses: actions/checkout@v2
        with:
          submodules: true

      - name: print-last-commit
        run: |
          echo "PWD = $PWD"
          git config --global --add safe.directory $PWD
          git rev-list --max-count=1 HEAD
